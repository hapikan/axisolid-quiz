<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Axisolid „Å©„Çì„Å†„ÅëÁü•„Å£„Å¶„Çì„Å≠„ÇìÈÅ∏ÊâãÊ®©</title>
  <style>
    body {
      text-align: center;
      font-family: sans-serif;
      background: transparent;
      position: relative;
    }
    body::before {
      content: "";
      background-image: url('images.jpeg');
      background-size: cover;
      background-position: center;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: -1;
      filter: blur(6px) brightness(0.6);
    }
    h1 {
      color: white;
      font-size: 48px;
      text-shadow: 1px 1px 3px #000;
      margin-top: 20px;
    }
    canvas {
      margin-top: 20px;
      width: 500px;
      height: 500px;
    }
    #spinBtn {
      margin-top: 20px;
      padding: 16px 32px;
      font-size: 24px;
    }
    #fullscreenBtn {
      position: absolute;
      top: 15px;
      right: 15px;
      padding: 8px 14px;
      font-size: 14px;
      background: rgba(255,255,255,0.8);
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    #result {
      margin-top: 60px;
      font-size: 48px;
      font-weight: bold;
      color: #fff;
      text-shadow: 2px 2px 4px #000;
    }
  </style>
</head>
<body>
  <button id="fullscreenBtn">ÂÖ®ÁîªÈù¢</button>
  <h1>Axisolid „Å©„Çì„Å†„ÅëÁü•„Å£„Å¶„Çì„Å≠„ÇìÈÅ∏ÊâãÊ®©</h1>
  <canvas id="wheel" width="500" height="500"></canvas><br>
  <button id="spinBtn">„É´„Éº„É¨„ÉÉ„Éà„ÇíÂõû„Åô</button>
  <div id="result"></div>

  <!-- ÂäπÊûúÈü≥ -->
  <audio id="tick" src="ÂõûËª¢Èü≥.mp3"></audio>
  <audio id="stopSound" src="stop.mp3"></audio>

  <script>
    const canvas = document.getElementById('wheel');
    const ctx = canvas.getContext('2d');
    const spinBtn = document.getElementById('spinBtn');
    const result = document.getElementById('result');
    const fullscreenBtn = document.getElementById('fullscreenBtn');
    const tick = document.getElementById("tick");
    const stopSound = document.getElementById("stopSound");

    stopSound.volume = Math.min(1, stopSound.volume * 1.3); // üîä stopÈü≥„Çí30%„Ç¢„ÉÉ„Éó

    const fullSegments = [
      "Â•Ω„Åç„Å™„Éü„É•„Éº„Ç∏„Ç∑„É£„É≥",
      "‰ΩøÁî®Ê•ΩÂô®„É°„Éº„Ç´„Éº",
      "Ë°ÄÊ∂≤Âûã„ÅØÔºü",
      "Â•Ω„Åç„Å™È£ü„ÅπÁâ©„ÅØÔºü",
      "‰πó„Å£„Å¶„ÅÑ„ÇãËªä„ÅÆËªäÁ®Æ„ÅØÔºü",
      "Ê•ΩÂô®Âπæ„Å§ÊâÄÊúâ„Åó„Å¶„ÅÑ„ÇãÔºü",
      "Â•Ω„Åç„Å™Êúç„ÅÆ„Éñ„É©„É≥„Éâ„ÅØÔºü",
      "ÊúÄËøëË≤∑„Å£„Åü„Å°„Çá„Å£„Å®È´ò„ÅÑË≤∑„ÅÑÁâ©„ÅØÔºü",
      "Ë™ïÁîüÊó•„ÅØÔºü",
      "Ë∫´Èï∑„ÅØÔºü",
      "Â•Ω„Åç„Å™Êò†Áîª„ÅØÔºü",
      "Âà©„ÅçÊâã„ÅØÔºü",
      "Â•Ω„Åç„Å™Ëâ≤„ÅØÔºü",
      "Â´å„ÅÑ„Å™È£ü„ÅπÁâ©„ÅØÔºü",
      "Ë∂£Âë≥„ÅØÔºü(Èü≥Ê•Ω‰ª•Â§ñ)",
      "„Éö„ÉÉ„Éà„ÅØ‰Ωï„ÇíÈ£º„Å£„Å¶„ÇãÔºü"
    ];

    let segments = [...fullSegments];

    const colors = Array.from({ length: fullSegments.length }, (_, i) =>
      `hsl(${i * 360 / fullSegments.length}, 70%, 70%)`
    );

    let startAngle = 0;
    const arc = Math.PI * 2 / fullSegments.length;
    let isSpinning = false;
    let totalRotation = 0;

    function drawWheel() {
      for (let i = 0; i < segments.length; i++) {
        const angle = startAngle + i * arc;
        ctx.fillStyle = colors[i % colors.length];
        ctx.beginPath();
        ctx.moveTo(250, 250);
        ctx.arc(250, 250, 230, angle, angle + arc);
        ctx.fill();
      }
    }

    function rotateWheel(duration = 6000) {
      let start = null;
      totalRotation = Math.random() * 360 + 1440;

      function animate(timestamp) {
        if (!start) start = timestamp;
        const progress = timestamp - start;
        const angle = easeOut(progress, 0, totalRotation, duration);
        startAngle = angle * Math.PI / 180;
        ctx.clearRect(0, 0, 500, 500);
        drawWheel();
        if (progress < duration) {
          requestAnimationFrame(animate);
        }
      }

      requestAnimationFrame(animate);
    }

    spinBtn.addEventListener('click', () => {
      if (isSpinning) return;
      isSpinning = true;
      result.innerText = "";
      rotateWheel();

      const tickInterval = setInterval(() => {
        tick.pause();
        tick.currentTime = 0;
        tick.play().catch(() => {});
      }, 200);

      setTimeout(() => {
        clearInterval(tickInterval);
        tick.pause();
        tick.currentTime = 0;

        const finalDeg = totalRotation % 360;
        const index = Math.floor((segments.length - (finalDeg / 360) * segments.length)) % segments.length;
        const chosen = segments[index];

        result.innerText = `„ÅäÈ°åÔºö„Äå${chosen}„Äç`;

        segments.splice(index, 1); // ‚úÖ 1ÂõûÂá∫È°å„Åó„Åü„ÇâÂâäÈô§

        if (segments.length === 0) {
          segments = [...fullSegments]; // ‚úÖ ÂÖ®„Å¶Âá∫È°å„Åó„Åü„Çâ„É™„Çª„ÉÉ„Éà
        }

        stopSound.pause();
        stopSound.currentTime = 0;
        stopSound.play().catch(() => {});

        isSpinning = false;
      }, 6000);
    });

    fullscreenBtn.addEventListener('click', () => {
      if (document.documentElement.requestFullscreen) {
        document.documentElement.requestFullscreen();
      }
    });

    function easeOut(t, b, c, d) {
      t /= d;
      t--;
      return c * (t * t * t + 1) + b;
    }

    drawWheel();
  </script>
</body>
</html>